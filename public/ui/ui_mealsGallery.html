<div class="container">
  <div class="row" >
    <div class="col-lg-4 col-md-4 col-sm-3 col-xs-10">
      <h2>Ricettario</h2>
    </div>
    <div align="right" class="visible-xs-block col-xs-2">
      <br/>
      <a role="button" class="btn btn-default" href="#/calculator"><span class="text-muted glyphicon glyphicon-plus" aria-hidden="true"></a>
    </div>
    <div class="col-lg-4 col-md-4 col-sm-6 col-xs-12">
      <form class="form-inline" role="form">
        <br class="hidden-xs" />
        <div class="input-group">
          <span class="input-group-addon"><span class="text-muted glyphicon glyphicon-search" aria-hidden="true"></span></span>
          <input id="search" type="text" class="form-control" placeholder="Cerca" ng-model="search.name">
        </div>
      </form>
    </div>
    <div align="right" class="hidden-xs col-lg-4 col-md-4 col-sm-3">
      <br/>
      <a role="button" class="btn btn-default" href="#/calculator"><span class="text-muted glyphicon glyphicon-plus" aria-hidden="true"></span>&nbsp;Aggiungi una ricetta</a>
    </div>
  </div>
  <div class="row" ng-show="alert">
    <br class="visible-xs-block" />
    <alert type="{{alert.type}}" close="onCloseAlert()">{{alert.msg}}</alert>
  </div>
  <div class="row">
    <div ng-repeat="meal in f_meals = (meals | filter: search | orderBy : '+name') | startFrom : firstVisibleItem | limitTo : itemsPerPage" class="col-md-4 col-sm-6 h4z-meal-cell" role="button" ng-click="onMealClicked(f_meals, $index)">
      <h4 class="h4z-meal-title">{{meal.name}}</h4>
      <div class="media h4z-media">
        <div class="media-left h4z-media-left">
          <table height="160px">
          <tr><td class="h4z-meal-right-pane" colspan=3 style="vertical-align:top; height:96px"><img class="media-object" ng-src="{{(meal.imageURL) ? meal.imageURL : noImage}}"/></td></tr>
            <tr><td class="h4z-meal-right-pane" colspan=3 align="center"><span class="badge h4z-calories-label">{{meal.totCalories}}</span> calorie</td></tr>
            <tr><td class="h4z-meal-right-pane" colspan=3 align="center"><span class="badge">{{meal.blocks}}</span> blocchi</td></tr>
            <tr height="100%">
              <td width="30px" class="h4z-meal-right-pane" style="vertical-align:bottom"><span class="h4z-icon-button text-muted glyphicon glyphicon-pencil " aria-hidden="true" ng-click="onEditClicked(meal, $event)"></span></td>
              <td width="30px" class="h4z-meal-right-pane" style="vertical-align:bottom"><span class="h4z-icon-button text-muted glyphicon glyphicon-duplicate" aria-hidden="true" ng-click="onDuplicateClicked(meal, $event)"></span></td>
              <td align="right" class="h4z-meal-right-pane" style="vertical-align:bottom"><span class="h4z-icon-button text-muted glyphicon glyphicon-remove" aria-hidden="true" ng-click="onRemoveClicked(meal, $index, $event)"></span></td>
            </tr>
          </table>
        </div>
        <div class="media-body">
          <table style="position: relative" width=100%>
            <tr ng-repeat="mealItem in meal.mealItems | limitTo : maxMealItems"><td style="vertical-align:top" align="right" width="60px">{{mealItem.qty}} <small>gr.</small>&nbsp;</td><td>{{mealItem.food.name}}</td>
            <tr ng-show="meal.mealItems.length > maxMealItems"><td colspan=2 class="h4z-more-indicator"><span class="glyphicon glyphicon-chevron-down" aria-hidden="true"></td></tr>
          </table>
        </div>
      </div>
    </div>
  </div>
  <div class="row">
    <pagination total-items="f_meals.length" items-per-page="itemsPerPage" max-size="5" rotate="false" ng-model="currentPage" ng-change="onPageChanged()"></pagination>
  </div>
</div> <!-- /container -->


<script type="text/ng-template" id="ui_mealCarousel.html">
   <div class="modal-body">
     <carousel id="mealCarousel" interval="-1">
       <slide ng-repeat="meal in meals | filter: search | orderBy : '+name'" active="meal.active">
        <h4 class="h4z-meal-title">{{meal.name}}</h4>
         <div class="media">
          <div class="media-left">
            <table>
              <tr><td style="vertical-align:top; height:150px"><img class="media-object" ng-src="{{(meal.bigImageURL) ? meal.bigImageURL : noImage}}" style="margin:auto;"/></td></tr>
              <tr><td style="padding-bottom: 5px; align=center"><span class="badge h4z-calories-label">{{meal.totCalories}}</span> calorie</td></tr>
              <tr><td style="padding-bottom: 5px; align=center"><span class="badge">{{meal.blocks}}</span> blocchi</td></tr>
              <tr><td style="padding-bottom: 5px; align=center"><span class="badge proteins-label">P {{meal.blockProteins | number:1}}</span>&nbsp;<span class="badge fats-label">G {{meal.blockFats | number:1}}</span>&nbsp;<span class="badge carbohydrates-label">C {{meal.blockCarbohydrates | number:1}}</span></td></tr>
            </table>
          </div>
          <div class="media-body">
            <table>
              <tr ng-repeat="mealItem in meal.mealItems">
                <td class="text-center" width=15><image width=15 ng-src="{{sourceImage(mealItem.food)}}"></td>
                <td style="vertical-align:top" align="right" width="60px">{{mealItem.qty}} <small>gr.</small>&nbsp;</td>
                <td align="left">{{mealItem.food.name}}</td>
              </tr>
            </table>
          </div>
         </div>
       </slide>
  </carousel>
  </div>
   <div class="modal-footer">
    <div class="h4z-div-left-inline"><button class="btn btn-default" type="button" ng-click="onActionClicked('edit')"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>&nbsp;&nbsp;Modifica</button></div>
    <div class="h4z-div-left-inline"><button class="btn btn-default" type="button" ng-click="onActionClicked('duplicate')"><span class="glyphicon glyphicon-duplicate" aria-hidden="true"></span>&nbsp;&nbsp;Copia</button></div>
    <div class="h4z-div-left-inline"><button class="btn btn-default" type="button" ng-click="onActionClicked('remove')"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span>&nbsp;&nbsp;Elimina</button></div>
    <button class="btn btn-default" type="button" ng-click="onCloseClicked()">Chiudi</button>
   </div>
 </script>
